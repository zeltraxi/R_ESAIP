# install.packages("dplyr")
library(dplyr)
# install.packages("ggplot2")
library(ggplot2)
# install.packages("tidyr") #tidy
library(tidyr)

####Import ISF Data####
old <- getwd() # répertoire courant d'exécution
setwd(dir= "C:/Users/Guillaume/Documents/esaip/IR5/R") # modifier le répertoire courant
getwd()
dFisf <- read.csv2("./isf2016Nettoye.csv",sep=";")
dFinsee <- read.csv2("./MDB-INSEE-V2.csv",sep=";")
dfinsee <- data.frame(dFinsee)

#trier la dataframe pour enlever les régions avec des données manquantes
dfinsee$DEP <- as.numeric(as.character(dfinsee$DEP))
dfinsee$DEP <- dfinsee$DEP[dfinsee$DEP < 96]

#### Nombre d'hotel et camping en fonction des logements vacants par département ####
dfinsee$log <- dfinsee$Nb.Camping + dfinsee$Nb.Hotel
dflogdep <- dfinsee %>% group_by(DEP) %>% summarise(Nb.Log.Vacants = sum(Nb.Log.Vacants),logement = sum(log))
dflogdep <- dflogdep %>% drop_na(logement)
dflogdep$log <- round(dflogdep$Nb.Log.Vacants / dflogdep$logement)

barplot(dflogdep$log,
        main = "Nombre de logements libres par département en fonction du nombre d'hotel et camping ",
        xlab = "Département",
        ylab = "Nombre de logements libres par nombre d'hotel et camping",
        names.arg = dflogdep$DEP,
        col = "navy",
        cex.names=0.4)
